<div class="space-y-6">
  <!-- CABECERA -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-[#556B2F]/10 p-4 rounded-lg border-l-4 border-[#556B2F]">
    <div>
      <h1 class="text-2xl font-bold text-[#556B2F]">Gestión de Turnos</h1>
      <p class="text-[#1C1C1C]/70">Organiza los horarios de tu equipo</p>
    </div>
    <button
      class="rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#556B2F] disabled:opacity-50 disabled:pointer-events-none h-10 py-2 px-4 flex items-center gap-2 bg-[#556B2F] hover:bg-[#556B2F]/90 text-white w-full sm:w-auto justify-center"
      (click)="openModal(0, 8)">
      <svg xmlns="http://www.w3.org/2000/svg" class="lucide lucide-plus h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path d="M5 12h14M12 5v14" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
      </svg>
      Programar Turno
    </button>
  </div>

  <!-- ESTADÍSTICAS -->
  <div class="grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
    <div class="rounded-lg border bg-white p-4 md:p-6 border-[#556B2F] bg-[#556B2F]/5">
      <p class="text-sm font-medium text-[#1C1C1C]/70">Turnos Activos</p>
      <h3 class="text-xl md:text-2xl font-bold text-[#1C1C1C] mt-1">{{ activeShiftsCount }}</h3>
    </div>
    <div class="rounded-lg border bg-white p-4 md:p-6 border-[#D4AF37] bg-[#D4AF37]/5">
      <p class="text-sm font-medium text-[#1C1C1C]/70">Turnos Pendientes</p>
      <h3 class="text-xl md:text-2xl font-bold text-[#1C1C1C] mt-1">{{ pendingShiftsCount }}</h3>
    </div>
    <div class="rounded-lg border bg-white p-4 md:p-6 border-[#556B2F] bg-[#556B2F]/5">
      <p class="text-sm font-medium text-[#1C1C1C]/70">Turnos Completados</p>
      <h3 class="text-xl md:text-2xl font-bold text-[#1C1C1C] mt-1">{{ completedShiftsCount }}</h3>
    </div>
    <div class="rounded-lg border bg-white p-4 md:p-6 border-[#D4AF37] bg-[#D4AF37]/5">
      <p class="text-sm font-medium text-[#1C1C1C]/70">Total Personal Hoy</p>
      <h3 class="text-xl md:text-2xl font-bold text-[#1C1C1C] mt-1">{{ todayStaffCount }}</h3>
    </div>
  </div>

  <!-- TURNOS DE HOY -->
  <div class="rounded-lg border bg-card shadow-sm border-[#D4AF37]/20">
    <div class="p-6 pb-0">
      <h3 class="text-2xl font-semibold text-[#556B2F]">Turnos de Hoy</h3>
      <p class="text-sm text-muted-foreground">{{ todayFormatted }}</p>
    </div>
    <div class="p-6 pt-3">
      <ng-container *ngIf="todayTurnos.length; else noShifts">
        <div *ngFor="let turno of todayTurnos" class="flex justify-between items-center p-4 rounded-lg bg-[#556B2F]/5 border border-[#D4AF37]/10">
          <div>
            <div class="font-medium text-[#1C1C1C]">Empleado {{ turno.empleado_id }}</div>
            <div class="text-sm text-[#1C1C1C]/70">Rol {{ turno.roles_id }}</div>
          </div>
          <div class="text-right">
            <div class="font-medium text-[#556B2F]">{{ turno.hora_inicio }} - {{ turno.hora_fin }}</div>
            <div class="text-sm text-[#1C1C1C]/70">{{ turno.duracion }} horas</div>
          </div>
          <div class="text-xs rounded-full px-2 py-1 bg-[#556B2F]/20 text-[#556B2F] font-medium">
            {{ turno.estado | titlecase }}
          </div>
        </div>
      </ng-container>
      <ng-template #noShifts>
        <div class="text-center text-[#1C1C1C]/60 py-8">No hay turnos programados para hoy.</div>
      </ng-template>
    </div>
  </div>

  <!-- VISTA SEMANAL -->
  <div class="rounded-lg border shadow-sm border-[#D4AF37]/20">
    <div class="flex justify-between items-center p-6">
      <div>
        <h3 class="text-2xl font-semibold text-[#556B2F]">Vista Semanal</h3>
        <p class="text-sm text-muted-foreground">Planificación de la semana actual</p>
      </div>
      <button (click)="openModal(0, 8)" class="flex items-center gap-2 rounded-md bg-[#D4AF37] hover:bg-[#EBCB64] text-white px-4 py-2 font-medium">
        <svg xmlns="http://www.w3.org/2000/svg" class="lucide lucide-plus h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path d="M5 10h14M12 5v14" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
        </svg>
        Añadir turno
      </button>
    </div>
    <div class="p-6 pt-0 grid grid-cols-8 gap-4">
      <div class="col-span-1"></div>
      <div *ngFor="let day of currentWeekDates; let i = index" class="text-center font-medium text-[#556B2F]">
        {{ getDayName(i) }}
      </div>
      <div class="col-span-8 grid grid-cols-8 gap-4 relative">
        <div class="col-span-1">
          <div *ngFor="let hour of hours" class="h-[60px] text-sm text-gray-500">
            {{ hour }}:00
          </div>
        </div>
        <div *ngFor="let day of currentWeekDates; let dayIndex = index" class="relative">
          <div *ngFor="let hour of hours"
               class="h-[60px] border border-[#D4AF37]/30 hover:bg-[#D4AF37]/10 cursor-pointer"
               (click)="openModal(dayIndex, hour)"
               (dragover)="allowDrop($event)"
               (drop)="onDrop($event, dayIndex, hour)">
          </div>
          <ng-container *ngFor="let turno of turnos">
            <div *ngIf="turno.fecha === day"
                 class="absolute text-white p-2 rounded cursor-move"
                 [ngClass]="turno.color"
                 [style.top.px]="turno.hora * 60"
                 [style.height.px]="turno.duracion * 60"
                 draggable="true"
                 (dragstart)="onDragStart(turno)"
                 (click)="onTurnoClick(turno)">
              <div class="text-sm font-medium">Empleado {{ turno.empleado_id }}</div>
              <div class="text-xs">{{ turno.hora_inicio }} - {{ turno.hora_fin }}</div>
              <div class="text-xs">{{ turno.estado | titlecase }}</div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL -->
  <app-turnos-modal
    [isOpen]="isModalOpen"
    [selectedDayIndex]="selectedDayIndex"
    [selectedHour]="selectedHour"
    [currentWeekDates]="currentWeekDates"
    [shiftToEdit]="selectedTurno"
    (close)="closeModal()"
    (create)="createTurno($event)"
    (update)="updateTurno($event)"
    (delete)="deleteTurno()">
  </app-turnos-modal>
</div>
